# Аппроксимация методом наименьших квадратов на полиномах Лежандра
## Описание теории
### Полиномы Лежандра
$P_0(x) = 1$ \
$P_1(x) = x$ \
$P_{n+1}(x) = \frac{2n+1}{n+1}xP_n(x) - \frac{n}{n+1}P_{n-1}(x)$ 

Для полиномов Лежандра выполняются все основные свойства базисных функций, что позволяет использовать их в методе наименьших квадратов:
- ортогональность на отрезке [-1, 1]
- линейная независимость
- полнота

### Аппроксимация методом наименьших квадратов
Метод наименьших квадратов – это статистический метод, используемый для аппроксимации функции к набору данных путем минимизации суммы квадратов отклонений между предсказанными значениями функции и реальными данными.

Функция аппроксимации представляет собой полином вида: 
$G(x)=c_0+c_1P_1(x)+c_2P_2(x)+ ... +c_nP_n(x)$, где $P_i(x)$ – полином Лежандра степени $i$,  $c_i$ – некоторые коэффициенты.

Необходимо найти такие значения коэффициентов, чтобы было верно следующее выражение:
$\sum_{i=1}^{n}(y_i - c_0 - c_1P_1(x_i) - c_2P_2(x_i) - ... - c_mP_m(x_i))^2 → min $

Для этого должны быть верны следующие равенства:

$\frac{∂G(x)}{∂c_0} = 0$ \
$\frac{∂G(x)}{∂c_1} = 0$ \
... \
$\frac{∂G(x)}{∂c_m} = 0$ 

#### Составление системы уравнений через частные производные
1. Найдём частные производные для функции аппроксимации и составим систему уравнений:

$\sum_{i=1}^{n}(c_0+c_1P_1(x_i) + ... +c_mP_m(x_i)) = \sum_{i=1}^{n}y_i$ \
$\sum_{i=1}^{n}(c_0+c_1P_1^2(x_i) + ... +c_mP_m(x_i)P_1(x_i)) = \sum_{i=1}^{n}P_1(x_i)y_i$ \
... \
$\sum_{i=1}^{n}(c_0+c_1P_1(x_i)P_m(x_i) + ... +c_mP_m^2(x_i)) = \sum_{i=1}^{n}P_m(x_i)y_i$

2. На основе полученных уравнений составим систему уравнений и запишем её в матричном виде для решения методом Гаусса (заменим $P_1(x_i)$ на $x_i$, так как это полином Лежандра первой степени):
   
![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/1db741d7-9138-4284-9150-a27872d0c41a)

#### Матричный способ получения системы уравнений
Для получения системы уравнений в виде матрицы необходимо совершить следующие действия:
1. Рассчитать значения полиномов Лежандра от степени 0 до m (заданной пользователем) для каждого значения x из исходного набора. Записать их в виде матрицы A, где каждой строке соответствуют значения полиномов для одного и того же значения x, а в каждом столбце записаны значения полиномов одного порядка:
   
![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/0b349328-9007-4c37-a94e-e02865043645)

2. Сформировать систему уравнений в матричном виде. Для этого необходимо найти результат умножения матриц $A^TA$ и $A^TY$, где $A^T$ – транспонированная матрица из предыдущего пункта, $Y$ – вектор значений $y$. Таким образом, уравнение, записанное с помощью матриц, принимает следующий вид:
$A^TAC$ = $A^TY$. Вектор $C$ содержит коэффициенты, которые необходимо найти.
- Транспонированная матрица $A^T$ принимает следующий вид:
  
![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/6b79e981-d024-4b07-9821-8667af3a0786)

- Матрица $A^TA$ будет выглядеть следующим образом:

![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/2be0480a-72a4-4262-b472-709d55dfb845)

- Матрицу $A^TY$ можно записать в виде таблицы:

![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/1dd9266a-78e5-42c2-a773-e42b064af85b)

3. Решить уравнение, например, использовав метод Гаусса. Для этого надо объединить матрицы $A_TA$ и $A_TY$:

![image](https://github.com/OlgaRhythm/Legendre-approximation/assets/87225985/6d7e964e-d464-4110-91bd-b7176f19fbc7)

В данной программе на Haskell реализовано составление матрицы для решения методом Гаусса именно через матрицы.

## Инструкция пользователя

1. Получить исполняемую программу program.exe (скомпилировать файл program.hs)
   При использовании GHC это реализуется путём выполнения в консоли команды: `ghc --make program.hs`
2. Создать и заполнить текстовый файл input.txt. В нём попарно на каждой строке должны быть записаны координаты точек для аппроксимации
3. Запустить program.exe (создастся текстовый файл output.txt) и следовать инструкции на экране (ввести целый положительный порядок полинома): `./program.exe`
5. Выполнить программу draw.py: `python draw.py` (убедитесь, что на компьютере установлен интерпретатор Python)
6. При успешной работе на экране появится изображение с графиком аппроксимации и точками, заданными в файле input.txt
